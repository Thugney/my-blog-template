---
title: "M365 Apps Not Updating? How Competing Update Policies Create a Security Blind Spot"
date: 2026-02-17
draft: false
tags: ["intune", "troubleshooting", "microsoft-365-apps", "security", "cloud-update"]
categories: ["Troubleshooting"]
summary: "How conflicting Intune Administrative Templates, Cloud Update profiles, and deployment XML kept 465 devices behind on security patches - and how to fix it with a single management authority."
description: "Troubleshoot Microsoft 365 Apps update failures caused by conflicting Intune policies, Cloud Update profiles, and deployment XML. Learn how to consolidate to a single update management authority."
keywords: ["M365 Apps not updating", "Office update conflict", "Intune update policy", "Cloud Update troubleshooting", "Microsoft 365 Apps update failure", "competing update policies", "Office security patches", "update channel conflict"]
---

## The Problem

The Microsoft 365 Apps security update dashboard painted a grim picture: **465 devices, zero on the latest build**. 362 devices were two or more builds behind, exposing the organization to **1,571 known security vulnerabilities**. Updates simply weren't reaching endpoints despite having update management configured in multiple places.

The instinct when you see this is to check deadlines, check network connectivity, check if devices are checking in. But the root cause was more architectural than operational — we had **three competing update management authorities** all trying to control M365 Apps updates simultaneously, and the result was that nothing worked.

## Environment

- **Intune-managed Windows 11 devices** (Entra-joined, Autopilot-provisioned)
- **Microsoft 365 E3 and A5 licenses**
- **M365 Apps for Enterprise** (64-bit, Norwegian language pack)
- **config.office.com** Cloud Update with two active profiles (Monthly Enterprise Channel and Current Channel)
- **Intune Administrative Template** policy targeting All Devices with update settings enabled

## Root Cause

Three layers were fighting over who controls M365 Apps updates:

### Layer 1: The Deployment XML

M365 Apps were deployed via Intune using an ODT configuration XML with `Channel="Current"`. This meant every device installed Office on **Current Channel** from day one. However, the organization's intended channel was **Monthly Enterprise Channel**.

```xml
<!-- Original — wrong channel -->
<Add OfficeClientEdition="64" Channel="Current" MigrateArch="TRUE">
```

### Layer 2: Intune Administrative Template

A configuration profile called "Win 10 - Office Updates" was assigned to **All Devices** with these settings enabled:

- Target Version: **Enabled**
- Enable Automatic Updates: **Enabled**
- Update Channel: **Enabled**
- Hide option to enable or disable updates: **Enabled**
- Update Deadline: **Enabled**

These settings write to the registry under `HKLM:\SOFTWARE\Policies\Microsoft\office\16.0\common\officeupdate`. The critical issue: when these GPO-style registry keys exist, **Cloud Update (config.office.com) cannot take management control of the device**. Microsoft explicitly documents this — Cloud Update defers to GPO/Intune policy registry keys when they're present.

If the Target Version was pinned to an older build, devices would never update beyond it. If it was empty but Enabled, it could still cause unpredictable behavior alongside Cloud Update.

### Layer 3: Cloud Update (config.office.com)

Two servicing profiles were active: one for Monthly Enterprise Channel and one for Current Channel, both broadly targeting devices. In theory, Cloud Update should have been pushing the latest builds. In practice, it was powerless — the Intune Administrative Template registry keys took precedence, effectively locking devices out of Cloud Update management.

### The Result

Devices were stuck: installed on Current Channel via the XML, held in place by GPO-style registry keys from the Admin Template, and unreachable by Cloud Update. Updates couldn't flow, and the security vulnerability count kept climbing.

## Solution

The fix is to consolidate to **one management authority** — Cloud Update via config.office.com — and remove everything that conflicts with it.

### Step 1: Fix the Deployment XML

Update the M365 Apps Intune deployment configuration to use Monthly Enterprise Channel for all new device installations:

```xml
<!-- Configuration ID is generated by config.office.com — generate your own at https://config.office.com -->
<Configuration ID="xxx-xxxx-xxx-xxx">
  <Add OfficeClientEdition="64" Channel="MonthlyEnterprise" MigrateArch="TRUE">
    <Product ID="O365ProPlusRetail">
      <Language ID="nb-no" /> 
      <!-- Exclude apps not needed in your org -->
      <ExcludeApp ID="Access" />
      <ExcludeApp ID="Groove" />   <!-- OneDrive for Business legacy sync client -->
      <ExcludeApp ID="Lync" />     <!-- Skype for Business — deprecated -->
      <ExcludeApp ID="MSTeams" />  <!-- Old bundled Teams — New Teams installs separately -->
    </Product>
  </Add>

  <!-- Licensing — all disabled for standard user-based licensing -->
  <Property Name="SharedComputerLicensing" Value="0" />
  <Property Name="SCLCacheOverride" Value="0" />
  <Property Name="AUTOACTIVATE" Value="0" />
  <Property Name="DeviceBasedLicensing" Value="0" />

  <!-- Force-close Office apps during install to prevent stuck installations -->
  <Property Name="FORCEAPPSHUTDOWN" Value="false" />

  <!-- No <Updates> element — Cloud Update (config.office.com) manages updates.
       Adding update settings here would conflict with Cloud Update. -->

  <AppSettings>
    <Setup Name="Company" Value="Org name" />
    <!-- Default save formats: Excel=.xlsx (51), PowerPoint=.pptx (27), Word=.docx (default) -->
    <User Key="software\microsoft\office\16.0\excel\options"
          Name="defaultformat" Value="51" Type="REG_DWORD"
          App="excel16" Id="L_SaveExcelfilesas" />
    <User Key="software\microsoft\office\16.0\powerpoint\options"
          Name="defaultformat" Value="27" Type="REG_DWORD"
          App="ppt16" Id="L_SavePowerPointfilesas" />
    <User Key="software\microsoft\office\16.0\word\options"
          Name="defaultformat" Value="" Type="REG_SZ"
          App="word16" Id="L_SaveWordfilesas" />
  </AppSettings>

  <!-- Full install UI with automatic EULA acceptance -->
  <Display Level="Full" AcceptEULA="TRUE" />
</Configuration>
```

This only affects new installations. Existing devices need the proactive remediation below.

### Step 2: Delete the Intune Administrative Template

Remove the "Win 10 - Office Updates" Administrative Template policy from Intune entirely. This is the **critical step** — as long as this policy exists, it will keep writing blocking registry keys to devices on every policy sync, overriding any remediation scripts.

Navigate to: **Intune Admin Center → Devices → Configuration → "Win 10 - Office Updates" → Delete**

If you need to keep the "Hide option to enable or disable updates" setting, create a new minimal policy with only that setting and set everything else to **Not Configured**.

### Step 3: Configure Cloud Update as the Single Authority

In **config.office.com → Cloud Update**:

1. Confirm the **Monthly Enterprise** profile is Active
2. Set a reasonable **Update Deadline** (e.g., 48 or 72 hours for security updates)
3. Optionally enable **Rollout waves** to stagger updates across pilot and production rings
4. Review the **Current Channel** profile — once all devices migrate to MEC, this profile will have zero devices

### Step 4: Deploy Proactive Remediation to Switch Existing Devices

Existing devices still on Current Channel with blocking registry keys need active remediation. Deploy this as a Proactive Remediation script pair in Intune.

**Detection script** — checks CDNBaseUrl, UpdateChannel, and blocking GPO registry keys:

```powershell
# Monthly Enterprise Channel CDNBaseUrl
$targetCDNBaseUrl = "http://officecdn.microsoft.com/pr/55336b82-a18d-4dd6-b5f6-9e5095c314a6"
$c2rRegPath = "HKLM:\SOFTWARE\Microsoft\Office\ClickToRun\Configuration"
$policiesRegPath = "HKLM:\SOFTWARE\Policies\Microsoft\office\16.0\common\officeupdate"

# Check CDNBaseUrl (effective channel)
$currentCDN = (Get-ItemProperty -Path $c2rRegPath -Name "CDNBaseUrl" -ErrorAction SilentlyContinue).CDNBaseUrl
if ($currentCDN -ne $targetCDNBaseUrl) { $nonCompliant = $true }

# Check for blocking policy keys that prevent Cloud Update
foreach ($key in @("updatebranch", "updatepath", "updatetargetversion")) {
    $value = (Get-ItemProperty -Path $policiesRegPath -Name $key -ErrorAction SilentlyContinue).$key
    if ($null -ne $value -and $value -ne "") { $nonCompliant = $true }
}

# Full script: https://github.com/Thugney/eriteach-scripts/blob/main/intune/remediations/m365apps-channel-switch-detection.ps1
```

**Remediation script** — removes blocking keys, sets the correct channel, triggers update check, and verifies:

```powershell
# Remove blocking policy keys
foreach ($key in @("updatebranch", "updatepath", "updatetargetversion",
                   "enableautomaticupdates", "updatedeadline")) {
    Remove-ItemProperty -Path $policiesRegPath -Name $key -Force -ErrorAction SilentlyContinue
}

# Set CDNBaseUrl and UpdateChannel to Monthly Enterprise Channel
Set-ItemProperty -Path $c2rRegPath -Name "CDNBaseUrl" -Value $targetCDNBaseUrl -Force
Set-ItemProperty -Path $c2rRegPath -Name "UpdateChannel" -Value $targetCDNBaseUrl -Force

# Trigger Office update check
$c2rExe = Join-Path $env:CommonProgramFiles "Microsoft Shared\ClickToRun\OfficeC2RClient.exe"
Start-Process -FilePath $c2rExe -ArgumentList "/update user displaylevel=false forceappshutdown=false" -Wait -NoNewWindow

# Full script: https://github.com/Thugney/eriteach-scripts/blob/main/intune/remediations/m365apps-channel-switch-remediation.ps1
```

Deploy in Intune: **Devices → [Remediations](https://intune.microsoft.com/#view/Microsoft_Intune_DeviceSettings/DevicesMenu/~/intents) → Create script package**, schedule Daily, run as System (64-bit).

### Step 5: Monitor

After deployment, monitor from two places:

- **config.office.com → Cloud Update → Monthly Enterprise → Overview** — watch devices appear under MEC management
- **Intune Admin Center → Reports → Microsoft 365 Apps updates** — watch the vulnerability count decrease

Allow **48–72 hours** for the full fleet to switch channels and pull the latest MEC build.

## Prevention / Best Practices

The core lesson: **never have more than one management authority for M365 Apps updates**.

Pick one of these and use it exclusively:

| Authority | Best For | How It Controls Updates |
|-----------|----------|------------------------|
| **Cloud Update (config.office.com)** | Most organizations | Service-side management, rollout waves, deadline enforcement |
| **Intune Admin Template** | Orgs needing granular GPO-style control | Registry-based policy, pinned versions, channel control |
| **Servicing profile via Intune** | Integrated Intune-first management | M365 Apps update policies in Intune portal |

If you use Cloud Update, do **not** set Update Channel, Target Version, or Update Path via Intune Administrative Templates or GPO. These registry keys block Cloud Update from managing the device.

The deployment XML channel should also match your intended servicing channel so new devices don't need a post-deployment channel switch. And critically — don't include an `<Updates>` element in the XML if Cloud Update is your authority.

## Scripts

- [m365apps-channel-switch-detection.ps1](https://github.com/Thugney/eriteach-scripts/blob/main/intune/remediations/m365apps-channel-switch-detection.ps1)
- [m365apps-channel-switch-remediation.ps1](https://github.com/Thugney/eriteach-scripts/blob/main/intune/remediations/m365apps-channel-switch-remediation.ps1)

## Related Links

- [Overview of Cloud Update - Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365-apps/admin-center/cloud-update)
- [Change the Microsoft 365 Apps update channel](https://learn.microsoft.com/en-us/microsoft-365-apps/updates/change-update-channels)
- [Update channel for Microsoft 365 Apps - Options](https://learn.microsoft.com/en-us/microsoft-365-apps/updates/overview-update-channels)
- [Proactive remediations in Intune](https://learn.microsoft.com/en-us/mem/intune/fundamentals/remediations)
